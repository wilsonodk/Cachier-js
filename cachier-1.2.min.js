/*
 * Cachier (Cache -> Cash -> Cashier) Version 1.2
 * Copyright (c) 2012 Wilson Wise http://wilson.odk.com
 * Cachier is licensed under a Creative Commons Attribution-NoDerivs 3.0 Unported License.
 *
 * JSON-js is required for use. https://github.com/douglascrockford/JSON-js
 */
var Cachier=(function(d){var b={},h=this,e=h.localStorage,c="cachier:data:{cid}",j="cachier:type:{cid}",i="cachier:expire:{cid}",k=/\{cid\}/,a=60*60*1000,l=d.stringify,g=d.parse;function f(m){return{data:c.replace(k,m),type:j.replace(k,m),expire:i.replace(k,m)}}b.getItem=function(r){var s=f(r),o=(new Date()).getTime(),m=parseInt(e.getItem(s.expire)),q={result:false,data:"",error:null},n,p;if(o<m){n=e.getItem(s.type);p=e.getItem(s.data);switch(n){case"object":q.data=g(p);q.result=true;break;case"number":q.data=Number(p);q.result=true;break;case"boolean":q.data=p=="true"?true:false;q.result=true;break;case"string":q.data=p;q.result=true;break;case"function":q.data="";q.result=false;q.error="Function was saved, unable to retrieve the value";break;default:q.data="";q.result=false;q.error="Unknown data type was saved";break}}else{Cachier.removeItem(r);q.error="Expired";return q}return q};b.setItem=function(r,q,n){var p=n||a,m=typeof q,s;if(typeof r!="string"){return false}switch(m){case"function":return false;break;case"object":q=l(q);break;case"string":break;case"number":case"boolean":default:q=q.toString();break}if(typeof q=="string"){s=f(r);p=(parseInt(p)+(new Date).getTime()).toString();try{e.setItem(s.data,q);e.setItem(s.type,m);e.setItem(s.expire,p)}catch(o){return false}}else{return false}return true};b.removeItem=function(n){try{var o=f(n);e.removeItem(o.data);e.removeItem(o.type);e.removeItem(o.expire)}catch(m){return false}return true};return b}(JSON));